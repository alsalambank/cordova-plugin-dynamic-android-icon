<plugin id="cordova-plugin-dynamic-icon" version="1.0.0" xmlns="http://apache.org/cordova/ns/plugins/1.0">
  <name>DynamicIcon</name>
  <description>Cordova plugin to change Android app icon using activity aliases</description>
  <license>MIT</license>

  <js-module src="www/DynamicIcon.js" name="DynamicIcon">
    <clobbers target="DynamicIcon" />
  </js-module>

  <platform name="android">
    <config-file target="AndroidManifest.xml" parent="/manifest/application">
      <activity-alias
        android:enabled="true"
        android:icon="@mipmap/ic_classic"
        android:label="@string/app_name"
        android:name=".ClassicAlias"
        android:targetActivity=".MainActivity"
        android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
      </activity-alias>

      <activity-alias
        android:enabled="false"
        android:icon="@mipmap/ic_retro"
        android:label="@string/app_name"
        android:name=".RetroAlias"
        android:targetActivity=".MainActivity"
        android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
      </activity-alias>

      <activity-alias
        android:enabled="false"
        android:icon="@mipmap/ic_private"
        android:label="@string/app_name"
        android:name=".PrivateAlias"
        android:targetActivity=".MainActivity"
        android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
      </activity-alias>
    </config-file>

    <!-- Remove LAUNCHER intent filter from MainActivity -->
    <config-file 
        target="AndroidManifest.xml"
        parent="/manifest/application/activity[@android:name='MainActivity']/intent-filter[action[@android:name='android.intent.action.MAIN'] and category[@android:name='android.intent.category.LAUNCHER']]"
        xmlns:android="http://schemas.android.com/apk/res/android">
        <!-- Empty means remove the intent-filter node -->
    </config-file>

    <hook type="after_plugin_install" src="hooks/after_plugin_install/copy-icons.js" />
  </platform>
</plugin>
