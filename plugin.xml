<plugin id="cordova-plugin-dynamic-icon" version="1.0.0" xmlns="http://apache.org/cordova/ns/plugins/1.0">
  <name>DynamicIcon</name>
  <description>Cordova plugin to change Android app icon using activity aliases</description>
  <license>MIT</license>

  <js-module src="www/DynamicIcon.js" name="DynamicIcon">
    <clobbers target="DynamicIcon" />
  </js-module>

  <platform name="android">
    <config-file target="AndroidManifest.xml" parent="/manifest/application">
      <activity-alias
        android:enabled="true"
        android:icon="@mipmap/ic_launcher_classic"
        android:label="@string/app_name"
        android:name="ClassicAlias"
        android:targetActivity=".MainActivity"
        android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
      </activity-alias>

      <activity-alias
        android:enabled="false"
        android:icon="@mipmap/ic_launcher_retro"
        android:label="@string/app_name"
        android:name="RetroAlias"
        android:targetActivity=".MainActivity"
        android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
      </activity-alias>

      <activity-alias
        android:enabled="false"
        android:icon="@mipmap/ic_launcher_private"
        android:label="@string/app_name"
        android:name="PrivateAlias"
        android:targetActivity=".MainActivity"
        android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
      </activity-alias>
    </config-file>

    <config-file target="res/xml/config.xml" parent="/*">
      <feature name="DynamicIcon">
        <param name="android-package" value="{PACKAGE_NAME}.DynamicIcon" />
        <param name="onload" value="true" />
      </feature>
    </config-file>

    <resource-file src="res/drawable/ic_launcher_foreground_classic.xml" target="res/drawable/ic_launcher_foreground_classic.xml" />
    <resource-file src="res/drawable/ic_launcher_foreground_retro.xml" target="res/drawable/ic_launcher_foreground_retro.xml" />
    <resource-file src="res/drawable/ic_launcher_foreground_private.xml" target="res/drawable/ic_launcher_foreground_private.xml" />
    <resource-file src="res/values/ic_launcher_colors.xml" target="res/values/ic_launcher_colors.xml" />

    <hook type="after_plugin_install" src="hooks/after_plugin_install/copy-icons.js" />
    <hook type="after_prepare" src="hooks/after_prepare/remove-launcher-intent.js" />
    <hook type="after_prepare" src="hooks/after_prepare/update-package-name.js" />
    <hook type="after_prepare" src="hooks/after_prepare/copy-adaptive-icons.js" />
  </platform>
</plugin>
